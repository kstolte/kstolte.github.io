<html>  
  <head>
      <meta charset="utf-8"/>
      <script src="wasm_exec.js"></script>
      <script>
          const go = new Go();
          WebAssembly.instantiateStreaming(fetch("toSql.wasm"), go.importObject).then((result) => {
              go.run(result.instance);
          });
      </script>
  </head>
  <body>
    <div>
      <p>DISCLAIMER: This is a work in progress and has not been tested entirely. Use at your own risk.</p>
      <p>Always check the sql output before executing on an actual server. Sql Injection is a Thing.</p>
      <ul>Known Issues:
        <li>Errant &apos; values in the input field - will be mitigated by replacing with an escaped version.</li>
      </ul>
    </div>
    <div>
      <label for="inputType">Input Type</label>
      <select id="inputType" name="inputType">
        <option value="excel">Excel</option>
        <option value="sheets">Google Sheets</option>
        <option value="numbers">Numbers</option>
        <option value="csv">Comma Separated Values (CSV)</option>
        <option value="tsv">Tab Separated Values (TSV)</option>
        <option value="scsv">SemiColon Separated Values</option>
      </select><br/>
      <label for="chkHeaders">First Line Is Headers</label>
      <input id="chkHeaders" name="chkHeaders" type="checkbox" checked="true" >
    </div>
    <label for="jsoninput">Data Input</label><br/>
    <textarea id="jsoninput" name="jsoninput" cols="100" rows="20"></textarea><br/>
    <input id="button" type="submit" name="button" value="GIVE ME SQL!" onclick="json(jsoninput.value, inputType.value, chkHeaders.checked)"/>
    <br/>
    <label for="jsonoutput">SQLized Output</label><br/>
    <textarea id="jsonoutput" name="jsonoutput" cols="100" rows="20"></textarea>
  </body>
  <script>
    var json = function(input, inputType, hasHeaders) {
      var delimiter = '\t'
      if(inputType==='csv')
        delimiter=','
      if(inputType==='scsv')
        delimiter=';'

      jsonoutput.value = "processing..."
      var resp = tsvToSQLImport(input, delimiter, hasHeaders)
      jsonoutput.value = resp !== undefined && resp.length > 1 ? resp : "probable error encountered, refresh page and check for blank input"      
    }
    </script>
</html>
